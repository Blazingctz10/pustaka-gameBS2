{% extends "base.html" %}

{% block title %}{{ judul_halaman }}{% endblock %}

{% block content %}
    <p><a href="{% url 'home' %}">&larr; Kembali ke Katalog</a></p>
    <hr>
    
    <div class="profile-layout">
        <aside class="profile-sidebar">
            <img class="profile-pic" src="{{ user.profile.gambar.url }}" alt="Foto Profil {{ user.username }}">
            
            <h2 class="profile-username">{{ user.username }}</h2>
            <span class="profile-usertype">{{ user.profile.tipe_user|capfirst }}</span>

            <div class="profile-update-form">
                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ p_form.gambar.errors }}
                    {{ p_form.gambar }} 
                    <label for="{{ p_form.gambar.id_for_label }}" class="btn-primary" style="cursor: pointer;">
                        Pilih Gambar
                    </label>
                    <button type="submit" class="btn-primary">Simpan</button>
                </form>
            </div>
        </aside>

        <div class="profile-main">
            <div class="profile-details">
                <h3>Detail Akun</h3>
                <p><strong>Email:</strong> {{ user.email }}</p>
                <p><strong>Tanggal Bergabung:</strong> {{ user.date_joined|date:"d F Y" }}</p>
            </div>

            <div class="comments-section">
                <h3>Riwayat Komentar ({{ user_comments.count }})</h3>
                {% for komentar in user_comments %}
                  <div class="comment">
                    <p>
                      Pada game <strong><a href="{% url 'detail_game' komentar.game.pk %}">{{ komentar.game.judul }}</a></strong>
                      <small class="comment-date"> - {{ komentar.tanggal_dibuat|date:"d M Y, H:i" }}</small>
                    </p>
                    <div class="comment-body">{{ komentar.isi_komentar|linebreaks }}</div>
                  </div>
                {% empty %}
                  <p>Anda belum pernah berkomentar.</p>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}